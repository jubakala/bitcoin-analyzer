import unittest
from unittest import TestCase
from utils import datetime_to_timestamp, add_hour, get_data, load_file, timestamp_to_date, get_days, create_price_date_dict, organize_prices_by_date, get_midnight_price, find_longest_bearish_trend, form_url, get_highest_trading_volume, downward_only, get_midnight_prices, get_days_to_by_and_sell


class ApiTest(TestCase):
	def test_datetime_to_timestamp(self):
		timestamp = datetime_to_timestamp("2020-01-01 00:00:00")
		expected = 1577836800

		self.assertEqual(timestamp, expected)


	def test_datetime_to_timestamp_invalid_input(self):
		timestamp = datetime_to_timestamp("12345678")

		self.assertIsNone(timestamp)


	def test_timestamp_to_date(self):
		date_time = timestamp_to_date(1577836800)
		expected = "2020-01-01"

		self.assertEqual(date_time, expected)


	# 1580511748596
	def test_timestamp_to_date2(self):
		date_time = timestamp_to_date(1580511748596)
		expected = "2020-01-31"

		self.assertEqual(date_time, expected)


	def test_get_days(self):
		data = load_file("prices.json")
		days = get_days(data)
		expected = ["2020-01-01", "2020-01-02", "2020-01-03", "2020-01-04", "2020-01-05", "2020-01-06", "2020-01-07", "2020-01-08", "2020-01-09", "2020-01-10", "2020-01-11", "2020-01-12", "2020-01-13", "2020-01-14", "2020-01-15", "2020-01-16", "2020-01-17", "2020-01-18", "2020-01-19", "2020-01-20", "2020-01-21", "2020-01-22", "2020-01-23", "2020-01-24", "2020-01-25", "2020-01-26", "2020-01-27", "2020-01-28", "2020-01-29", "2020-01-30", "2020-01-31", "2020-02-01", "2020-02-02", "2020-02-03", "2020-02-04", "2020-02-05", "2020-02-06", "2020-02-07", "2020-02-08", "2020-02-09", "2020-02-10", "2020-02-11", "2020-02-12", "2020-02-13", "2020-02-14", "2020-02-15", "2020-02-16", "2020-02-17", "2020-02-18", "2020-02-19", "2020-02-20", "2020-02-21", "2020-02-22", "2020-02-23", "2020-02-24", "2020-02-25", "2020-02-26", "2020-02-27", "2020-02-28", "2020-02-29", "2020-03-01", "2020-03-02", "2020-03-03", "2020-03-04", "2020-03-05", "2020-03-06", "2020-03-07", "2020-03-08", "2020-03-09", "2020-03-10", "2020-03-11", "2020-03-12", "2020-03-13", "2020-03-14", "2020-03-15", "2020-03-16", "2020-03-17", "2020-03-18", "2020-03-19", "2020-03-20", "2020-03-21", "2020-03-22", "2020-03-23", "2020-03-24", "2020-03-25", "2020-03-26", "2020-03-27", "2020-03-28", "2020-03-29", "2020-03-30", "2020-03-31", "2020-04-01", "2020-04-02", "2020-04-03", "2020-04-04", "2020-04-05", "2020-04-06", "2020-04-07", "2020-04-08", "2020-04-09", "2020-04-10", "2020-04-11", "2020-04-12", "2020-04-13", "2020-04-14", "2020-04-15", "2020-04-16", "2020-04-17", "2020-04-18", "2020-04-19", "2020-04-20", "2020-04-21", "2020-04-22", "2020-04-23", "2020-04-24", "2020-04-25", "2020-04-26", "2020-04-27", "2020-04-28", "2020-04-29", "2020-04-30", "2020-05-01", "2020-05-02", "2020-05-03", "2020-05-04", "2020-05-05", "2020-05-06", "2020-05-07", "2020-05-08", "2020-05-09", "2020-05-10", "2020-05-11", "2020-05-12", "2020-05-13", "2020-05-14", "2020-05-15", "2020-05-16", "2020-05-17", "2020-05-18", "2020-05-19", "2020-05-20", "2020-05-21", "2020-05-22", "2020-05-23", "2020-05-24", "2020-05-25", "2020-05-26", "2020-05-27", "2020-05-28", "2020-05-29", "2020-05-30", "2020-05-31", "2020-06-01", "2020-06-02", "2020-06-03", "2020-06-04", "2020-06-05", "2020-06-06", "2020-06-07", "2020-06-08", "2020-06-09", "2020-06-10", "2020-06-11", "2020-06-12", "2020-06-13", "2020-06-14", "2020-06-15", "2020-06-16", "2020-06-17", "2020-06-18", "2020-06-19", "2020-06-20", "2020-06-21", "2020-06-22", "2020-06-23", "2020-06-24", "2020-06-25", "2020-06-26", "2020-06-27", "2020-06-28", "2020-06-29", "2020-06-30", "2020-07-01", "2020-07-02", "2020-07-03", "2020-07-04", "2020-07-05", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-11", "2020-07-12", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-18", "2020-07-19", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-25", "2020-07-26", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-01", "2020-08-02", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-08", "2020-08-09", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-15", "2020-08-16", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-22", "2020-08-23", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-29", "2020-08-30", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-05", "2020-09-06", "2020-09-07", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-12", "2020-09-13", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-19", "2020-09-20", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-26", "2020-09-27", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-03", "2020-10-04", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-10", "2020-10-11", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-17", "2020-10-18", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-24", "2020-10-25", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29", "2020-10-30", "2020-10-31", "2020-11-01", "2020-11-02", "2020-11-03", "2020-11-04", "2020-11-05", "2020-11-06", "2020-11-07", "2020-11-08", "2020-11-09", "2020-11-10", "2020-11-11", "2020-11-12", "2020-11-13", "2020-11-14", "2020-11-15", "2020-11-16", "2020-11-17", "2020-11-18", "2020-11-19", "2020-11-20", "2020-11-21", "2020-11-22", "2020-11-23", "2020-11-24", "2020-11-25", "2020-11-26", "2020-11-27", "2020-11-28", "2020-11-29", "2020-11-30", "2020-12-01", "2020-12-02", "2020-12-03", "2020-12-04", "2020-12-05", "2020-12-06", "2020-12-07", "2020-12-08", "2020-12-09", "2020-12-10", "2020-12-11", "2020-12-12", "2020-12-13", "2020-12-14", "2020-12-15", "2020-12-16", "2020-12-17", "2020-12-18", "2020-12-19", "2020-12-20", "2020-12-21", "2020-12-22", "2020-12-23", "2020-12-24", "2020-12-25", "2020-12-26", "2020-12-27", "2020-12-28", "2020-12-29", "2020-12-30", "2020-12-31"]

		self.assertEqual(days, expected)


	def test_add_hour(self):
		# Add an hour to '2021-01-01'.
		added_timestamp = add_hour(1609459200)
		expected = 1609462800

		self.assertEqual(added_timestamp, expected)

		# Invalid input.
		added_timestamp = add_hour("something")
		self.assertIsNone(added_timestamp)


	def test_form_url(self):
		crypto_currency = "bitcoin"
		fiat_currency = "eur"
		start_date = "2020-01-01"
		end_date = "2020-12-31"

		url_data = form_url(crypto_currency, fiat_currency, start_date, end_date)
		expected = { "url": "https://api.coingecko.com/api/v3/coins/bitcoin/market_chart/range?vs_currency=eur&from=1577836800&to=1609376400", "error": "" }

		self.assertEqual(url_data['url'], expected['url'])
		self.assertEqual(url_data['error'], expected['error'])


	def test_get_data_by_url(self):
		crypto_currency = "bitcoin"
		fiat_currency = "eur"
		start_date = "1577836800"
		#end_date = "1609376400"
		end_date = "1580515200"

		url = f"https://api.coingecko.com/api/v3/coins/{crypto_currency}/market_chart/range?vs_currency={fiat_currency}&from={start_date}&to={end_date}"
		json_data = get_data(url)

		self.assertTrue('prices' in json_data)


	def test_get_data_by_url_invalid_url(self):
		crypto_currency = "scroogecoin"
		fiat_currency = "eur"
		start_date = "this_is_a_date"
		end_date = "another_date"

		url = f"https://api.coingecko.com/api/v3/coins/{crypto_currency}/market_chart/range?vs_currency={fiat_currency}&from={start_date}&to={end_date}"
		json_data = get_data(url)

		self.assertTrue('prices' in json_data)
		self.assertEqual(len(json_data['prices']), 0)


	def test_create_price_date_dict(self):
		data = load_file("prices.json")
		days = get_days(data)

		price_date_dict = create_price_date_dict(days)
		expected = { "2020-01-01": [], "2020-01-02": [], "2020-01-03": [], "2020-01-04": [], "2020-01-05": [], "2020-01-06": [], "2020-01-07": [], "2020-01-08": [], "2020-01-09": [], "2020-01-10": [], "2020-01-11": [], "2020-01-12": [], "2020-01-13": [], "2020-01-14": [], "2020-01-15": [], "2020-01-16": [], "2020-01-17": [], "2020-01-18": [], "2020-01-19": [], "2020-01-20": [], "2020-01-21": [], "2020-01-22": [], "2020-01-23": [], "2020-01-24": [], "2020-01-25": [], "2020-01-26": [], "2020-01-27": [], "2020-01-28": [], "2020-01-29": [], "2020-01-30": [], "2020-01-31": [], "2020-02-01": [], "2020-02-02": [], "2020-02-03": [], "2020-02-04": [], "2020-02-05": [], "2020-02-06": [], "2020-02-07": [], "2020-02-08": [], "2020-02-09": [], "2020-02-10": [], "2020-02-11": [], "2020-02-12": [], "2020-02-13": [], "2020-02-14": [], "2020-02-15": [], "2020-02-16": [], "2020-02-17": [], "2020-02-18": [], "2020-02-19": [], "2020-02-20": [], "2020-02-21": [], "2020-02-22": [], "2020-02-23": [], "2020-02-24": [], "2020-02-25": [], "2020-02-26": [], "2020-02-27": [], "2020-02-28": [], "2020-02-29": [], "2020-03-01": [], "2020-03-02": [], "2020-03-03": [], "2020-03-04": [], "2020-03-05": [], "2020-03-06": [], "2020-03-07": [], "2020-03-08": [], "2020-03-09": [], "2020-03-10": [], "2020-03-11": [], "2020-03-12": [], "2020-03-13": [], "2020-03-14": [], "2020-03-15": [], "2020-03-16": [], "2020-03-17": [], "2020-03-18": [], "2020-03-19": [], "2020-03-20": [], "2020-03-21": [], "2020-03-22": [], "2020-03-23": [], "2020-03-24": [], "2020-03-25": [], "2020-03-26": [], "2020-03-27": [], "2020-03-28": [], "2020-03-29": [], "2020-03-30": [], "2020-03-31": [], "2020-04-01": [], "2020-04-02": [], "2020-04-03": [], "2020-04-04": [], "2020-04-05": [], "2020-04-06": [], "2020-04-07": [], "2020-04-08": [], "2020-04-09": [], "2020-04-10": [], "2020-04-11": [], "2020-04-12": [], "2020-04-13": [], "2020-04-14": [], "2020-04-15": [], "2020-04-16": [], "2020-04-17": [], "2020-04-18": [], "2020-04-19": [], "2020-04-20": [], "2020-04-21": [], "2020-04-22": [], "2020-04-23": [], "2020-04-24": [], "2020-04-25": [], "2020-04-26": [], "2020-04-27": [], "2020-04-28": [], "2020-04-29": [], "2020-04-30": [], "2020-05-01": [], "2020-05-02": [], "2020-05-03": [], "2020-05-04": [], "2020-05-05": [], "2020-05-06": [], "2020-05-07": [], "2020-05-08": [], "2020-05-09": [], "2020-05-10": [], "2020-05-11": [], "2020-05-12": [], "2020-05-13": [], "2020-05-14": [], "2020-05-15": [], "2020-05-16": [], "2020-05-17": [], "2020-05-18": [], "2020-05-19": [], "2020-05-20": [], "2020-05-21": [], "2020-05-22": [], "2020-05-23": [], "2020-05-24": [], "2020-05-25": [], "2020-05-26": [], "2020-05-27": [], "2020-05-28": [], "2020-05-29": [], "2020-05-30": [], "2020-05-31": [], "2020-06-01": [], "2020-06-02": [], "2020-06-03": [], "2020-06-04": [], "2020-06-05": [], "2020-06-06": [], "2020-06-07": [], "2020-06-08": [], "2020-06-09": [], "2020-06-10": [], "2020-06-11": [], "2020-06-12": [], "2020-06-13": [], "2020-06-14": [], "2020-06-15": [], "2020-06-16": [], "2020-06-17": [], "2020-06-18": [], "2020-06-19": [], "2020-06-20": [], "2020-06-21": [], "2020-06-22": [], "2020-06-23": [], "2020-06-24": [], "2020-06-25": [], "2020-06-26": [], "2020-06-27": [], "2020-06-28": [], "2020-06-29": [], "2020-06-30": [], "2020-07-01": [], "2020-07-02": [], "2020-07-03": [], "2020-07-04": [], "2020-07-05": [], "2020-07-06": [], "2020-07-07": [], "2020-07-08": [], "2020-07-09": [], "2020-07-10": [], "2020-07-11": [], "2020-07-12": [], "2020-07-13": [], "2020-07-14": [], "2020-07-15": [], "2020-07-16": [], "2020-07-17": [], "2020-07-18": [], "2020-07-19": [], "2020-07-20": [], "2020-07-21": [], "2020-07-22": [], "2020-07-23": [], "2020-07-24": [], "2020-07-25": [], "2020-07-26": [], "2020-07-27": [], "2020-07-28": [], "2020-07-29": [], "2020-07-30": [], "2020-07-31": [], "2020-08-01": [], "2020-08-02": [], "2020-08-03": [], "2020-08-04": [], "2020-08-05": [], "2020-08-06": [], "2020-08-07": [], "2020-08-08": [], "2020-08-09": [], "2020-08-10": [], "2020-08-11": [], "2020-08-12": [], "2020-08-13": [], "2020-08-14": [], "2020-08-15": [], "2020-08-16": [], "2020-08-17": [], "2020-08-18": [], "2020-08-19": [], "2020-08-20": [], "2020-08-21": [], "2020-08-22": [], "2020-08-23": [], "2020-08-24": [], "2020-08-25": [], "2020-08-26": [], "2020-08-27": [], "2020-08-28": [], "2020-08-29": [], "2020-08-30": [], "2020-08-31": [], "2020-09-01": [], "2020-09-02": [], "2020-09-03": [], "2020-09-04": [], "2020-09-05": [], "2020-09-06": [], "2020-09-07": [], "2020-09-08": [], "2020-09-09": [], "2020-09-10": [], "2020-09-11": [], "2020-09-12": [], "2020-09-13": [], "2020-09-14": [], "2020-09-15": [], "2020-09-16": [], "2020-09-17": [], "2020-09-18": [], "2020-09-19": [], "2020-09-20": [], "2020-09-21": [], "2020-09-22": [], "2020-09-23": [], "2020-09-24": [], "2020-09-25": [], "2020-09-26": [], "2020-09-27": [], "2020-09-28": [], "2020-09-29": [], "2020-09-30": [], "2020-10-01": [], "2020-10-02": [], "2020-10-03": [], "2020-10-04": [], "2020-10-05": [], "2020-10-06": [], "2020-10-07": [], "2020-10-08": [], "2020-10-09": [], "2020-10-10": [], "2020-10-11": [], "2020-10-12": [], "2020-10-13": [], "2020-10-14": [], "2020-10-15": [], "2020-10-16": [], "2020-10-17": [], "2020-10-18": [], "2020-10-19": [], "2020-10-20": [], "2020-10-21": [], "2020-10-22": [], "2020-10-23": [], "2020-10-24": [], "2020-10-25": [], "2020-10-26": [], "2020-10-27": [], "2020-10-28": [], "2020-10-29": [], "2020-10-30": [], "2020-10-31": [], "2020-11-01": [], "2020-11-02": [], "2020-11-03": [], "2020-11-04": [], "2020-11-05": [], "2020-11-06": [], "2020-11-07": [], "2020-11-08": [], "2020-11-09": [], "2020-11-10": [], "2020-11-11": [], "2020-11-12": [], "2020-11-13": [], "2020-11-14": [], "2020-11-15": [], "2020-11-16": [], "2020-11-17": [], "2020-11-18": [], "2020-11-19": [], "2020-11-20": [], "2020-11-21": [], "2020-11-22": [], "2020-11-23": [], "2020-11-24": [], "2020-11-25": [], "2020-11-26": [], "2020-11-27": [], "2020-11-28": [], "2020-11-29": [], "2020-11-30": [], "2020-12-01": [], "2020-12-02": [], "2020-12-03": [], "2020-12-04": [], "2020-12-05": [], "2020-12-06": [], "2020-12-07": [], "2020-12-08": [], "2020-12-09": [], "2020-12-10": [], "2020-12-11": [], "2020-12-12": [], "2020-12-13": [], "2020-12-14": [], "2020-12-15": [], "2020-12-16": [], "2020-12-17": [], "2020-12-18": [], "2020-12-19": [], "2020-12-20": [], "2020-12-21": [], "2020-12-22": [], "2020-12-23": [], "2020-12-24": [], "2020-12-25": [], "2020-12-26": [], "2020-12-27": [], "2020-12-28": [], "2020-12-29": [], "2020-12-30": [], "2020-12-31": [] }

		self.assertEqual(price_date_dict, expected)


	def test_organize_prices_by_date_daterange_a_year(self):
		data = load_file("prices.json")
		days = get_days(data)
		price_date_dict = create_price_date_dict(days)
		organized_prices = organize_prices_by_date(price_date_dict, data['prices'])
		expected = { "2020-01-01": [[1577836800000, 6412.84639784161]], "2020-01-02": [[1577923200000, 6412.448167227617]], "2020-01-03": [[1578009600000, 6234.201691113153]], "2020-01-04": [[1578096000000, 6541.826288033036]], "2020-01-05": [[1578182400000, 6587.5542745885095]], "2020-01-06": [[1578268800000, 6585.067986168254]], "2020-01-07": [[1578355200000, 6908.875149666955]], "2020-01-08": [[1578441600000, 7307.840392228419]], "2020-01-09": [[1578528000000, 7240.405633221215]], "2020-01-10": [[1578614400000, 7051.270625680576]], "2020-01-11": [[1578700800000, 7355.917442287579]], "2020-01-12": [[1578787200000, 7203.8185560592965]], "2020-01-13": [[1578873600000, 7350.567593453083]], "2020-01-14": [[1578960000000, 7282.907675838368]], "2020-01-15": [[1579046400000, 7910.127234921121]], "2020-01-16": [[1579132800000, 7909.779781948214]], "2020-01-17": [[1579219200000, 7829.528156380277]], "2020-01-18": [[1579305600000, 8027.134873079848]], "2020-01-19": [[1579392000000, 8030.890983244613]], "2020-01-20": [[1579478400000, 7833.230953209291]], "2020-01-21": [[1579564800000, 7778.071763455781]], "2020-01-22": [[1579651200000, 7870.658879746492]], "2020-01-23": [[1579737600000, 7810.331599413813]], "2020-01-24": [[1579824000000, 7613.073822327722]], "2020-01-25": [[1579910400000, 7648.164647841271]], "2020-01-26": [[1579996800000, 7572.214712229956]], "2020-01-27": [[1580083200000, 7796.2224179936775]], "2020-01-28": [[1580169600000, 8057.801665076384]], "2020-01-29": [[1580256000000, 8456.002845134844]], "2020-01-30": [[1580342400000, 8423.048513793692]], "2020-01-31": [[1580428800000, 8621.674924158713]], "2020-02-01": [[1580515200000, 8389.345427319253]], "2020-02-02": [[1580601600000, 8439.673223938584]], "2020-02-03": [[1580688000000, 8421.00124360104]], "2020-02-04": [[1580774400000, 8414.074850958064]], "2020-02-05": [[1580860800000, 8311.45251345368]], "2020-02-06": [[1580947200000, 8720.215991025094]], "2020-02-07": [[1581033600000, 8874.333340727395]], "2020-02-08": [[1581120000000, 8952.952499313633]], "2020-02-09": [[1581206400000, 9035.660390545574]], "2020-02-10": [[1581292800000, 9267.77436576357]], "2020-02-11": [[1581379200000, 9064.068629026156]], "2020-02-12": [[1581465600000, 9364.887969202422]], "2020-02-13": [[1581552000000, 9498.454201543153]], "2020-02-14": [[1581638400000, 9427.221702081284]], "2020-02-15": [[1581724800000, 9528.786850665145]], "2020-02-16": [[1581811200000, 9135.14704759717]], "2020-02-17": [[1581897600000, 9172.104193060246]], "2020-02-18": [[1581984000000, 8973.010783617869]], "2020-02-19": [[1582070400000, 9385.333662658793]], "2020-02-20": [[1582156800000, 8897.615277595773]], "2020-02-21": [[1582243200000, 8906.052218360242]], "2020-02-22": [[1582329600000, 8918.091267330046]], "2020-02-23": [[1582416000000, 8904.365511276923]], "2020-02-24": [[1582502400000, 9178.113475174932]], "2020-02-25": [[1582588800000, 8912.83484692709]], "2020-02-26": [[1582675200000, 8589.865197726598]], "2020-02-27": [[1582761600000, 8086.452074445834]], "2020-02-28": [[1582848000000, 7983.949940681771]], "2020-02-29": [[1582934400000, 7905.163813893958]], "2020-03-01": [[1583020800000, 7755.841979740712]], "2020-03-02": [[1583107200000, 7752.92714460959]], "2020-03-03": [[1583193600000, 7992.133215964888]], "2020-03-04": [[1583280000000, 7834.793731545937]], "2020-03-05": [[1583366400000, 7863.399408076787]], "2020-03-06": [[1583452800000, 8050.153492926535]], "2020-03-07": [[1583539200000, 8094.523173716613]], "2020-03-08": [[1583625600000, 7887.475558622892]], "2020-03-09": [[1583712000000, 7060.954210304582]], "2020-03-10": [[1583798400000, 6946.604182128345]], "2020-03-11": [[1583884800000, 6983.359700416577]], "2020-03-12": [[1583971200000, 7046.267440349036]], "2020-03-13": [[1584057600000, 4598.178050723126]], "2020-03-14": [[1584144000000, 4974.929966159308]], "2020-03-15": [[1584230400000, 4678.712747298543]], "2020-03-16": [[1584316800000, 4823.873940742251]], "2020-03-17": [[1584403200000, 4509.855956130319]], "2020-03-18": [[1584489600000, 4892.479304081295]], "2020-03-19": [[1584576000000, 4902.587403714269]], "2020-03-20": [[1584662400000, 5787.117525771312]], "2020-03-21": [[1584748800000, 5756.657388117135]], "2020-03-22": [[1584835200000, 5709.826778852306]], "2020-03-23": [[1584921600000, 5477.598417843867]], "2020-03-24": [[1585008000000, 5998.902353887937]], "2020-03-25": [[1585094400000, 6226.460655803391]], "2020-03-26": [[1585180800000, 6150.003928681609]], "2020-03-27": [[1585267200000, 6124.403291833885]], "2020-03-28": [[1585353600000, 5729.253477015574]], "2020-03-29": [[1585440000000, 5600.570981980311]], "2020-03-30": [[1585526400000, 5310.452523354348]], "2020-03-31": [[1585612800000, 5805.568079756095]], "2020-04-01": [[1585699200000, 5822.4575514861135]], "2020-04-02": [[1585785600000, 6066.182725839648]], "2020-04-03": [[1585872000000, 6278.1405114434065]], "2020-04-04": [[1585958400000, 6231.624849885226]], "2020-04-05": [[1586044800000, 6348.384048054807]], "2020-04-06": [[1586131200000, 6281.340833200699]], "2020-04-07": [[1586217600000, 6757.435383722668]], "2020-04-08": [[1586304000000, 6605.429805649589]], "2020-04-09": [[1586390400000, 6760.1286423845995]], "2020-04-10": [[1586476800000, 6676.419538243631]], "2020-04-11": [[1586563200000, 6276.863623084775]], "2020-04-12": [[1586649600000, 6290.322116196425]], "2020-04-13": [[1586736000000, 6323.950264013107]], "2020-04-14": [[1586822400000, 6277.747369241966]], "2020-04-15": [[1586908800000, 6244.820521048719]], "2020-04-16": [[1586995200000, 6080.236353989298]], "2020-04-17": [[1587081600000, 6500.850667019917]], "2020-04-18": [[1587168000000, 6469.204363378254]], "2020-04-19": [[1587254400000, 6659.778500105977]], "2020-04-20": [[1587340800000, 6557.760026966851]], "2020-04-21": [[1587427200000, 6310.620650491164]], "2020-04-22": [[1587513600000, 6302.078595586479]], "2020-04-23": [[1587600000000, 6578.985292859865]], "2020-04-24": [[1587686400000, 6851.232037740289]], "2020-04-25": [[1587772800000, 6924.154651408166]], "2020-04-26": [[1587859200000, 6965.921306796378]], "2020-04-27": [[1587945600000, 7100.961549107702]], "2020-04-28": [[1588032000000, 7181.850202872891]], "2020-04-29": [[1588118400000, 7163.313642757775]], "2020-04-30": [[1588204800000, 8038.370007921691]], "2020-05-01": [[1588291200000, 7867.761810408942]], "2020-05-02": [[1588377600000, 7954.947237709745]], "2020-05-03": [[1588464000000, 8081.762895076149]], "2020-05-04": [[1588550400000, 8110.104251182714]], "2020-05-05": [[1588636800000, 8147.88152142371]], "2020-05-06": [[1588723200000, 8305.957582914905]], "2020-05-07": [[1588809600000, 8468.364275636452]], "2020-05-08": [[1588896000000, 9190.388483091274]], "2020-05-09": [[1588982400000, 8954.565019778931]], "2020-05-10": [[1589068800000, 8720.46181011697]], "2020-05-11": [[1589155200000, 8076.68748052757]], "2020-05-12": [[1589241600000, 7961.116172011543]], "2020-05-13": [[1589328000000, 8101.085611075934]], "2020-05-14": [[1589414400000, 8578.852541566412]], "2020-05-15": [[1589500800000, 9065.58786685775]], "2020-05-16": [[1589587200000, 8602.515037129955]], "2020-05-17": [[1589673600000, 8663.505801366833]], "2020-05-18": [[1589760000000, 8932.517630843413]], "2020-05-19": [[1589846400000, 8893.367790448134]], "2020-05-20": [[1589932800000, 8932.534067290839]], "2020-05-21": [[1590019200000, 8676.19057826932]], "2020-05-22": [[1590105600000, 8274.210078575754]], "2020-05-23": [[1590192000000, 8377.38284872019]], "2020-05-24": [[1590278400000, 8412.788365688826]], "2020-05-25": [[1590364800000, 8004.922136091924]], "2020-05-26": [[1590451200000, 8149.898829672694]], "2020-05-27": [[1590537600000, 8050.512264626668]], "2020-05-28": [[1590624000000, 8327.485032318018]], "2020-05-29": [[1590710400000, 8618.036354672655]], "2020-05-30": [[1590796800000, 8489.07476063891]], "2020-05-31": [[1590883200000, 8701.218324700274]], "2020-06-01": [[1590969600000, 8513.951139778357]], "2020-06-02": [[1591056000000, 9139.332656460681]], "2020-06-03": [[1591142400000, 8506.999104148701]], "2020-06-04": [[1591228800000, 8584.870098314315]], "2020-06-05": [[1591315200000, 8614.252385199457]], "2020-06-06": [[1591401600000, 8535.123073514798]], "2020-06-07": [[1591488000000, 8557.640255583976]], "2020-06-08": [[1591574400000, 8604.7475065964]], "2020-06-09": [[1591660800000, 8646.746499888024]], "2020-06-10": [[1591747200000, 8617.878073129736]], "2020-06-11": [[1591833600000, 8685.052389860908]], "2020-06-12": [[1591920000000, 8258.589886025959]], "2020-06-13": [[1592006400000, 8413.32049257224]], "2020-06-14": [[1592092800000, 8413.267325810108]], "2020-06-15": [[1592179200000, 8304.428332243695]], "2020-06-16": [[1592265600000, 8321.983173811092]], "2020-06-17": [[1592352000000, 8455.98220240086]], "2020-06-18": [[1592438400000, 8418.558997364693]], "2020-06-19": [[1592524800000, 8386.735504604761]], "2020-06-20": [[1592611200000, 8330.22592679265]], "2020-06-21": [[1592697600000, 8374.295608719134]], "2020-06-22": [[1592784000000, 8319.838528907994]], "2020-06-23": [[1592870400000, 8584.508072201117]], "2020-06-24": [[1592956800000, 8507.06595186394]], "2020-06-25": [[1593043200000, 8255.814453055787]], "2020-06-26": [[1593129600000, 8252.296333941973]], "2020-06-27": [[1593216000000, 8171.198437888594]], "2020-06-28": [[1593302400000, 8034.824156146585]], "2020-06-29": [[1593388800000, 8141.368843362288]], "2020-06-30": [[1593475200000, 8163.959724661558]], "2020-07-01": [[1593561600000, 8144.167549314312]], "2020-07-02": [[1593648000000, 8203.363708558636]], "2020-07-03": [[1593734400000, 8091.533089939427]], "2020-07-04": [[1593820800000, 8065.3684415381895]], "2020-07-05": [[1593907200000, 8121.749286492225]], "2020-07-06": [[1593993600000, 8078.705100885547]], "2020-07-07": [[1594080000000, 8259.12793830662]], "2020-07-08": [[1594166400000, 8205.990402445177]], "2020-07-09": [[1594252800000, 8319.298777202946]], "2020-07-10": [[1594339200000, 8181.099093247821]], "2020-07-11": [[1594425600000, 8214.533825232174]], "2020-07-12": [[1594512000000, 8171.962177274989]], "2020-07-13": [[1594598400000, 8219.669309084125]], "2020-07-14": [[1594684800000, 8141.989652316821]], "2020-07-15": [[1594771200000, 8105.9734060818755]], "2020-07-16": [[1594857600000, 8060.5611939591245]], "2020-07-17": [[1594944000000, 8022.554186634305]], "2020-07-18": [[1595030400000, 8012.181511502039]], "2020-07-19": [[1595116800000, 8021.70143789932]], "2020-07-20": [[1595203200000, 8041.75186442637]], "2020-07-21": [[1595289600000, 7998.4762466819175]], "2020-07-22": [[1595376000000, 8132.522261758876]], "2020-07-23": [[1595462400000, 8225.782663152648]], "2020-07-24": [[1595548800000, 8268.647711869198]], "2020-07-25": [[1595635200000, 8181.110755394266]], "2020-07-26": [[1595721600000, 8314.849390480349]], "2020-07-27": [[1595808000000, 8516.612323079422]], "2020-07-28": [[1595894400000, 9317.952595801691]], "2020-07-29": [[1595980800000, 9305.841377244684]], "2020-07-30": [[1596067200000, 9411.765156730098]], "2020-07-31": [[1596153600000, 9367.800977294917]], "2020-08-01": [[1596240000000, 9615.200712279546]], "2020-08-02": [[1596326400000, 10028.267261267707]], "2020-08-03": [[1596412800000, 9394.032439349676]], "2020-08-04": [[1596499200000, 9549.539792495829]], "2020-08-05": [[1596585600000, 9472.358867901452]], "2020-08-06": [[1596672000000, 9870.186405878985]], "2020-08-07": [[1596758400000, 9908.763558966106]], "2020-08-08": [[1596844800000, 9818.708410297182]], "2020-08-09": [[1596931200000, 9960.957876348775]], "2020-08-10": [[1597017600000, 9915.750087336437]], "2020-08-11": [[1597104000000, 10104.850599220059]], "2020-08-12": [[1597190400000, 9709.672976448235]], "2020-08-13": [[1597276800000, 9816.775156630929]], "2020-08-14": [[1597363200000, 10001.279526780683]], "2020-08-15": [[1597449600000, 9945.064780536964]], "2020-08-16": [[1597536000000, 10018.999358929797]], "2020-08-17": [[1597622400000, 10041.99299246381]], "2020-08-18": [[1597708800000, 10333.845746774328]], "2020-08-19": [[1597795200000, 10003.13883962256]], "2020-08-20": [[1597881600000, 9907.416497090384]], "2020-08-21": [[1597968000000, 9993.443112482619]], "2020-08-22": [[1598054400000, 9762.303593100985]], "2020-08-23": [[1598140800000, 9899.437960198073]], "2020-08-24": [[1598227200000, 9870.454289679794]], "2020-08-25": [[1598313600000, 9971.48624607278]], "2020-08-26": [[1598400000000, 9588.81006382656]], "2020-08-27": [[1598486400000, 9683.68511565841]], "2020-08-28": [[1598572800000, 9559.187782321487]], "2020-08-29": [[1598659200000, 9674.642594493249]], "2020-08-30": [[1598745600000, 9643.032509322002]], "2020-08-31": [[1598832000000, 9818.956018885257]], "2020-09-01": [[1598918400000, 9776.78535959722]], "2020-09-02": [[1599004800000, 9974.610365860795]], "2020-09-03": [[1599091200000, 9634.43790751692]], "2020-09-04": [[1599177600000, 8613.253846922327]], "2020-09-05": [[1599264000000, 8856.62006575121]], "2020-09-06": [[1599350400000, 8597.555553056365]], "2020-09-07": [[1599436800000, 8668.042597062857]], "2020-09-08": [[1599523200000, 8765.924275376934]], "2020-09-09": [[1599609600000, 8603.660583815532]], "2020-09-10": [[1599696000000, 8666.32210124299]], "2020-09-11": [[1599782400000, 8745.454087116239]], "2020-09-12": [[1599868800000, 8761.244003123085]], "2020-09-13": [[1599955200000, 8811.467026471148]], "2020-09-14": [[1600041600000, 8723.336795824247]], "2020-09-15": [[1600128000000, 8983.519437063293]], "2020-09-16": [[1600214400000, 9109.291629624606]], "2020-09-17": [[1600300800000, 9276.457153583979]], "2020-09-18": [[1600387200000, 9228.814141975428]], "2020-09-19": [[1600473600000, 9228.743337564398]], "2020-09-20": [[1600560000000, 9361.72235984177]], "2020-09-21": [[1600646400000, 9218.381071831582]], "2020-09-22": [[1600732800000, 8872.842469854337]], "2020-09-23": [[1600819200000, 8990.707407345302]], "2020-09-24": [[1600905600000, 8769.23611779217]], "2020-09-25": [[1600992000000, 9188.034600001185]], "2020-09-26": [[1601078400000, 9184.111260761954]], "2020-09-27": [[1601164800000, 9236.288187287017]], "2020-09-28": [[1601251200000, 9252.775798367516]], "2020-09-29": [[1601337600000, 9142.097204182532]], "2020-09-30": [[1601424000000, 9229.987751235554]], "2020-10-01": [[1601510400000, 9186.376992440666]], "2020-10-02": [[1601596800000, 9049.721618464619]], "2020-10-03": [[1601683200000, 9023.323353491749]], "2020-10-04": [[1601769600000, 9001.117607747685]], "2020-10-05": [[1601856000000, 9106.37607239346]], "2020-10-06": [[1601942400000, 9148.35490107342]], "2020-10-07": [[1602028800000, 9037.156332689581]], "2020-10-08": [[1602115200000, 9066.58253791113]], "2020-10-09": [[1602201600000, 9254.854797482747]], "2020-10-10": [[1602288000000, 9351.191952980775]], "2020-10-11": [[1602374400000, 9539.92700342876]], "2020-10-12": [[1602460800000, 9624.493604248644]], "2020-10-13": [[1602547200000, 9770.15073511698]], "2020-10-14": [[1602633600000, 9730.84854294106]], "2020-10-15": [[1602720000000, 9738.613536849927]], "2020-10-16": [[1602806400000, 9819.494216600913]], "2020-10-17": [[1602892800000, 9660.849960075877]], "2020-10-18": [[1602979200000, 9700.722360830845]], "2020-10-19": [[1603065600000, 9811.865588251083]], "2020-10-20": [[1603152000000, 9986.104746091092]], "2020-10-21": [[1603238400000, 10069.51600843137]], "2020-10-22": [[1603324800000, 10804.047049367744]], "2020-10-23": [[1603411200000, 10959.523161793859]], "2020-10-24": [[1603497600000, 10900.291228593838]], "2020-10-25": [[1603584000000, 11048.305051913621]], "2020-10-26": [[1603670400000, 10993.599553091]], "2020-10-27": [[1603756800000, 11059.1474408289]], "2020-10-28": [[1603843200000, 11589.865932101582]], "2020-10-29": [[1603929600000, 11306.914101245698]], "2020-10-30": [[1604016000000, 11513.00925748653]], "2020-10-31": [[1604102400000, 11594.589763561095]], "2020-11-01": [[1604188800000, 11799.308784328252]], "2020-11-02": [[1604275200000, 11787.189975430128]], "2020-11-03": [[1604361600000, 11646.673457440633]], "2020-11-04": [[1604448000000, 11900.53141915714]], "2020-11-05": [[1604534400000, 12017.313197910922]], "2020-11-06": [[1604620800000, 13163.189005249455]], "2020-11-07": [[1604707200000, 13094.306490895644]], "2020-11-08": [[1604793600000, 12479.379990544032]], "2020-11-09": [[1604880000000, 13029.783004003737]], "2020-11-10": [[1604966400000, 12970.985144090215]], "2020-11-11": [[1605052800000, 12928.99690121876]], "2020-11-12": [[1605139200000, 13317.69688820948]], "2020-11-13": [[1605225600000, 13779.93203759942]], "2020-11-14": [[1605312000000, 13794.427927065117]], "2020-11-15": [[1605398400000, 13599.04334696278]], "2020-11-16": [[1605484800000, 13494.485394017931]], "2020-11-17": [[1605571200000, 14093.585337468716]], "2020-11-18": [[1605657600000, 14879.725592257313]], "2020-11-19": [[1605744000000, 15041.921518713621]], "2020-11-20": [[1605830400000, 15016.246273383784]], "2020-11-21": [[1605916800000, 15711.504039026126]], "2020-11-22": [[1606003200000, 15762.916674081463]], "2020-11-23": [[1606089600000, 15501.83292598104]], "2020-11-24": [[1606176000000, 15505.01794999028]], "2020-11-25": [[1606262400000, 16046.941545895852]], "2020-11-26": [[1606348800000, 15737.328737432834]], "2020-11-27": [[1606435200000, 14387.255809449201]], "2020-11-28": [[1606521600000, 14327.744877385607]], "2020-11-29": [[1606608000000, 14810.545193935972]], "2020-11-30": [[1606694400000, 15179.579485845135]], "2020-12-01": [[1606780800000, 16425.876414817623]], "2020-12-02": [[1606867200000, 15619.881669757768]], "2020-12-03": [[1606953600000, 15854.611867672349]], "2020-12-04": [[1607040000000, 16000.596011570113]], "2020-12-05": [[1607126400000, 15434.42300033802]], "2020-12-06": [[1607212800000, 15787.374660624046]], "2020-12-07": [[1607299200000, 15942.074754616388]], "2020-12-08": [[1607385600000, 15850.227460489148]], "2020-12-09": [[1607472000000, 15143.962364062603]], "2020-12-10": [[1607558400000, 15371.864480269156]], "2020-12-11": [[1607644800000, 15037.928500959382]], "2020-12-12": [[1607731200000, 14909.700563052313]], "2020-12-13": [[1607817600000, 15528.172355145709]], "2020-12-14": [[1607904000000, 15782.488180596785]], "2020-12-15": [[1607990400000, 15853.786913729256]], "2020-12-16": [[1608076800000, 15987.004593260697]], "2020-12-17": [[1608163200000, 17479.182574774823]], "2020-12-18": [[1608249600000, 18596.370302565916]], "2020-12-19": [[1608336000000, 18862.385711373685]], "2020-12-20": [[1608422400000, 19468.77710395562]], "2020-12-21": [[1608508800000, 19250.28454854162]], "2020-12-22": [[1608595200000, 18662.460684275353]], "2020-12-23": [[1608681600000, 19533.859665926884]], "2020-12-24": [[1608768000000, 19123.05975513076]], "2020-12-25": [[1608854400000, 19502.82377403685]], "2020-12-26": [[1608940800000, 20235.24254736353]], "2020-12-27": [[1609027200000, 21715.72193838337]], "2020-12-28": [[1609113600000, 21651.457904372615]], "2020-12-29": [[1609200000000, 22197.54271283681]], "2020-12-30": [[1609286400000, 22383.990968366867]], "2020-12-31": [[1609372800000, 23445.60952998802]] }

		self.assertEqual(organized_prices, expected)


	def test_organize_prices_by_date_daterange_a_month(self):
		data = load_file("prices_1_month.json")
		days = get_days(data)
		price_date_dict = create_price_date_dict(days)
		organized_prices = organize_prices_by_date(price_date_dict, data['prices'])

		expected = { '2020-01-01': [[1577837037103, 6412.84639784161], [1577840443088, 6400.183195857016], [1577844174112, 6452.701266161403], [1577848140451, 6472.734997584653], [1577851238015, 6463.273479119187], [1577855114844, 6459.984936772221], [1577858869352, 6466.275022382196], [1577862464201, 6445.939706616753], [1577866051896, 6427.706404769181], [1577869367988, 6408.749636232671], [1577872864963, 6408.922572379971], [1577876736509, 6416.878539022916], [1577880529069, 6416.232375709836], [1577883926430, 6420.0381517729265], [1577887639980, 6415.875056068972], [1577890824719, 6440.739721596347], [1577894995373, 6430.386758909359], [1577898034524, 6458.564511092221], [1577901618835, 6447.260372770252], [1577905779503, 6427.049100904037], [1577908846483, 6418.772496993268], [1577912653436, 6448.265169960227], [1577916261128, 6424.911291990242], [1577919763140, 6412.022709010401]], '2020-01-02': [[1577923235223, 6413.051795808254], [1577927145804, 6419.084371212281], [1577930733698, 6392.367191498962], [1577934447405, 6378.0750217390005], [1577937931269, 6348.1781473406545], [1577941655270, 6373.474640375365], [1577945118069, 6363.841848813113], [1577948687580, 6359.356689913901], [1577952284835, 6344.350466003507], [1577955849770, 6375.709214312489], [1577959753494, 6390.020679840621], [1577963256994, 6393.573096018375], [1577966701336, 6382.492481923091], [1577970568353, 6391.428200519827], [1577973646800, 6363.1359014027885], [1577977521707, 6383.578389826709], [1577981168137, 6378.76254467646], [1577984566594, 6321.199403361324], [1577988735259, 6234.781879558442], [1577991745726, 6248.848795231115], [1577995453801, 6256.160212581229], [1577999375587, 6232.533890958317], [1578002702067, 6249.198431984557], [1578006042775, 6249.151313222172]], '2020-01-03': [[1578009753859, 6234.201691113153], [1578013376974, 6208.2132684513745], [1578017140219, 6167.359386785936], [1578020565250, 6232.0724455879945], [1578024181938, 6224.754518066332], [1578027848478, 6442.959768783382], [1578031781963, 6451.014567855194], [1578035383720, 6454.849204795101], [1578039136603, 6456.646894042999], [1578042550412, 6501.495021137109], [1578045917445, 6575.980520043903], [1578049785960, 6556.6013907666165], [1578052956990, 6585.6544783208665], [1578056948195, 6572.322762399607], [1578060613843, 6596.713483631406], [1578063886955, 6505.161507419115], [1578067779922, 6530.111401518196], [1578071089895, 6590.155810278457], [1578074875152, 6574.184454867066], [1578078595350, 6561.34701223339], [1578081639042, 6563.349848480058], [1578085808118, 6550.83307843603], [1578089350779, 6527.501113198925], [1578092860577, 6544.7744179780875]], '2020-01-04': [[1578096759734, 6562.265113840174], [1578099910412, 6543.001543143275], [1578103371241, 6545.908380074012], [1578107042161, 6554.168732840087], [1578110970852, 6557.034942774186], [1578114551703, 6559.7147248819965], [1578118345005, 6579.059938470739], [1578121832428, 6573.2405571656955], [1578125360384, 6574.060485158502], [1578128723646, 6581.4006405916125], [1578132563409, 6589.698526635394], [1578135876881, 6581.659180120405], [1578139442193, 6566.669677887554], [1578143250885, 6548.902321175738], [1578147139999, 6549.688591253432], [1578150473761, 6553.050931533596], [1578154152865, 6556.307448707838], [1578157759262, 6545.484836583716], [1578160832608, 6572.636131990251], [1578164973422, 6546.105516932859], [1578168562341, 6567.076174493328], [1578172074657, 6577.404682642825], [1578175746624, 6586.3718626540685], [1578178968651, 6583.923942697398]], '2020-01-05': [[1578182557849, 6587.5542745885095], [1578186037824, 6614.086171011091], [1578189927593, 6697.118147362596], [1578193497176, 6665.634955147715], [1578196955622, 6687.129532697173], [1578200561108, 6674.754692383923], [1578204466679, 6675.354713765041], [1578208163861, 6670.281036672763], [1578211737732, 6682.698655449359], [1578214968839, 6648.527160820329], [1578218965599, 6649.192316953088], [1578222335840, 6640.644760998615], [1578226061235, 6648.748471019759], [1578229385702, 6678.475336590817], [1578233070830, 6654.342890963778], [1578236698509, 6655.075457537782], [1578240165102, 6679.462917120068], [1578243867479, 6679.455944115287], [1578247491641, 6678.938058706598], [1578251110030, 6652.698684123616], [1578254689344, 6662.503608813751], [1578258297214, 6652.881011469095], [1578261939600, 6611.116748356305], [1578265750822, 6582.144281315466]], '2020-01-06': [[1578269098636, 6585.067986168254], [1578272980116, 6606.852508329435], [1578276171693, 6640.415170459463], [1578280174238, 6770.177607692057], [1578283540599, 6751.466911553703], [1578287127321, 6736.698609525158], [1578290986043, 6736.675490112882], [1578294172179, 6723.357918809646], [1578298175904, 6722.633209747217], [1578301347205, 6744.83268743122], [1578304952253, 6733.871826317682], [1578308546761, 6748.032950334676], [1578312147483, 6721.369901509123], [1578315955659, 6747.61248474203], [1578319769636, 6696.832322039812], [1578323098600, 6732.940508541077], [1578326856088, 6717.2130322080975], [1578330174671, 6724.71024135232], [1578333891121, 6739.932549698233], [1578337536973, 6719.819417966853], [1578341386249, 6729.605649892657], [1578344722827, 6735.7595408548905], [1578348232933, 6756.798808515135], [1578351936508, 6870.096936942493]], '2020-01-07': [[1578355365953, 6908.875149666955], [1578358963505, 7006.051884262777], [1578362986941, 7049.542616743956], [1578366824105, 7038.546426886405], [1578370184143, 7046.424138320396], [1578373780528, 6990.923488005786], [1578377413769, 7024.954400677326], [1578380545118, 7027.521457321368], [1578384170703, 7038.3521516048695], [1578387841442, 7031.573465406744], [1578391453948, 7007.189483568325], [1578395164449, 7045.856474396703], [1578399129052, 7047.678942365348], [1578402596263, 7018.57303376012], [1578406224311, 7021.13137611967], [1578409366389, 7032.020303207234], [1578412951794, 6944.5756016245095], [1578416455058, 7093.203186644873], [1578420158105, 7090.610048503986], [1578423642570, 7207.584188356921], [1578427481923, 7216.43647070947], [1578430958656, 7305.38391502185], [1578434577715, 7175.553314113382], [1578438285968, 7184.319743433374]], '2020-01-08': [[1578442190171, 7296.6434538809835], [1578445655359, 7517.619897359079], [1578449061266, 7459.8328577254515], [1578452994669, 7388.339811631671], [1578456617823, 7433.477371291936], [1578459930125, 7479.3759265757635], [1578463738460, 7459.391968533826], [1578467341836, 7446.6178566547605], [1578470948342, 7420.474355598171], [1578474541098, 7453.755994635471], [1578477865251, 7416.280511414674], [1578481556256, 7482.838174299395], [1578485547334, 7471.907984198252], [1578488855311, 7447.9351997800595], [1578492028761, 7503.369401331947], [1578495909499, 7432.14641229751], [1578499937176, 7436.282357740554], [1578503098523, 7287.093595783671], [1578506670301, 7257.371087070993], [1578510310066, 7232.639680590605], [1578513759423, 7184.683378262281], [1578517778243, 7236.804417638257], [1578521122217, 7210.857346680501], [1578525023416, 7239.0780343639735]], '2020-01-09': [[1578528151586, 7223.161778446997], [1578531858661, 7164.775350281474], [1578535666677, 7192.669624241178], [1578539258200, 7178.066129187692], [1578542718742, 7159.1061532943795], [1578546156171, 7170.576397440469], [1578549758810, 7140.328292269635], [1578553941873, 7139.394349436004], [1578557426649, 7151.231509362794], [1578560741567, 7143.177405299881], [1578564333989, 7101.024796694147], [1578567772830, 7085.375052734637], [1578571788389, 7111.121345016373], [1578575391695, 7133.088834141914], [1578578656818, 7114.252269255008], [1578582587042, 7091.620235067659], [1578585959175, 7118.904258135725], [1578589493007, 7047.9450313179095], [1578593366721, 7015.728705508039], [1578596953892, 7032.805875290853], [1578600475226, 7125.960556932457], [1578603856995, 7046.668804591055], [1578607500758, 7025.551761385551], [1578611156712, 7033.851496106093]], '2020-01-10': [[1578614868756, 7045.348592698507], [1578618289968, 7045.446819456071], [1578622036557, 7028.369729807162], [1578625737155, 7027.36726152911], [1578628952020, 7023.343271067451], [1578632434336, 7020.318156840756], [1578636141971, 6990.38260339649], [1578639911281, 6984.065071797056], [1578643380432, 6972.302379274711], [1578646958052, 6943.51933511472], [1578650862496, 6958.549818158419], [1578654151501, 6997.0218692937515], [1578658158767, 7059.88811547209], [1578661570281, 7106.1609149295755], [1578665100930, 7087.279521256999], [1578668662020, 7177.189816635022], [1578672145391, 7232.037514864458], [1578675775813, 7146.275798727462], [1578679783284, 7171.553660919106], [1578683345307, 7193.414346444169], [1578686855123, 7235.97024587247], [1578690270613, 7242.366247989194], [1578694060420, 7224.2356870935355], [1578697774311, 7242.875725742168]], '2020-01-11': [[1578701089748, 7355.917442287579], [1578704971440, 7328.916973598822], [1578708572082, 7346.967656675996], [1578711920176, 7362.043820211557], [1578715746674, 7324.419119289895], [1578719403110, 7268.345105860641], [1578723003394, 7252.1344508037855], [1578726330461, 7294.834731025473], [1578730159904, 7236.789975105889], [1578733498114, 7228.191679447108], [1578737540962, 7254.132178063423], [1578740730410, 7203.822813512382], [1578744336366, 7210.045589234502], [1578747884533, 7238.741148714742], [1578751488057, 7256.221765676556], [1578755110713, 7234.221833672753], [1578758701851, 7267.899218140428], [1578762148985, 7331.904158386651], [1578765890480, 7319.167739155057], [1578769652327, 7328.068644602491], [1578773393638, 7313.841067071516], [1578776414082, 7318.28124904608], [1578780167353, 7266.184887146106], [1578783748901, 7238.084943243668]], '2020-01-12': [[1578787356743, 7203.8185560592965], [1578790836850, 7243.501970802429], [1578794446865, 7239.830863597422], [1578798157042, 7264.283249912214], [1578801619428, 7270.614631044076], [1578805650121, 7251.9403473098555], [1578809095697, 7272.957316519899], [1578812668039, 7271.73943045334], [1578816046800, 7270.404637379327], [1578820132816, 7298.889803959934], [1578823521357, 7292.0584660285485], [1578827241554, 7288.248688199211], [1578830580327, 7277.95071773593], [1578834173347, 7304.1834228533135], [1578838159021, 7337.846124895081], [1578841372470, 7307.933632406967], [1578845376271, 7323.654539772664], [1578848657775, 7282.974995563068], [1578852246682, 7288.302608811948], [1578855628367, 7292.490570725216], [1578859763348, 7298.2916393035375], [1578862969160, 7307.112704838726], [1578866956696, 7279.0031571186855], [1578870007016, 7328.136179182073]], '2020-01-13': [[1578873776464, 7350.567593453083], [1578877248563, 7319.989543990349], [1578881141884, 7327.207709620055], [1578884548181, 7290.50665353575], [1578888175226, 7281.365059825556], [1578891625036, 7284.552412293713], [1578895239571, 7253.481370743992], [1578898823831, 7237.682248496413], [1578902761482, 7251.734907258292], [1578906154719, 7280.376263627844], [1578910141862, 7286.4683792803235], [1578913469208, 7285.517244486882], [1578917147577, 7258.741004600263], [1578920423302, 7255.906500759197], [1578924003307, 7257.272107883072], [1578927635879, 7262.813763426818], [1578931814120, 7250.204171569016], [1578934950252, 7262.64681076083], [1578938976053, 7251.413702591085], [1578942152239, 7265.257187604144], [1578945762661, 7264.659229785571], [1578949235774, 7299.496737878983], [1578952840669, 7295.384920196403], [1578956663566, 7277.327293004883]], '2020-01-14': [[1578960560139, 7273.8260917656835], [1578964152846, 7395.370199218562], [1578967435721, 7539.688817091693], [1578970952896, 7535.969585970999], [1578974575944, 7580.030783319579], [1578978548619, 7623.406244419935], [1578981890316, 7579.137524822199], [1578985740118, 7613.00123626455], [1578989370357, 7626.372888858632], [1578992563520, 7637.155228038437], [1578996562481, 7604.088796662922], [1578999766258, 7628.838570537268], [1579003478703, 7628.59237561119], [1579007055446, 7622.189299168555], [1579010854305, 7685.342434833916], [1579014333007, 7804.057720463868], [1579017768148, 7823.908478963389], [1579021241103, 7751.307391968186], [1579024987794, 7873.793402513619], [1579028432897, 7841.143816457552], [1579032543033, 7858.4075426684885], [1579035912661, 7785.04918734097], [1579039647652, 7834.357152277683], [1579043079314, 7871.663081776743]], '2020-01-15': [[1579046669094, 7910.127234921121], [1579050351355, 7887.025685462284], [1579053956196, 7875.319346561441], [1579057666226, 7880.219053975434], [1579061083504, 7842.488695386701], [1579064926362, 7715.518111963183], [1579068270928, 7711.800177228782], [1579071890626, 7759.074023745673], [1579075467951, 7732.188322071616], [1579079060672, 7759.447865066557], [1579082650794, 7838.884900680342], [1579086322652, 7865.033316815664], [1579089849285, 7794.941004569147], [1579093482473, 7823.40627184812], [1579097114944, 7947.2267450132285], [1579100570309, 7937.036134046098], [1579104330274, 7854.902496106836], [1579107790133, 7858.028102629257], [1579111248222, 7872.530726756705], [1579115356990, 7843.549202217468], [1579118746448, 7862.013622869238], [1579122316931, 7910.365461802004], [1579125773546, 7906.473450611625], [1579129371406, 7930.982913278055]], '2020-01-16': [[1579133139069, 7909.942042304699], [1579136861445, 7848.99013244826], [1579140164426, 7754.014104027246], [1579143872945, 7748.411233519834], [1579147392682, 7752.261777964055], [1579150985517, 7739.728525628127], [1579154720937, 7790.192972581135], [1579158246416, 7810.665242203503], [1579161852763, 7763.514254519754], [1579165492365, 7751.082097811731], [1579168980368, 7735.451143362909], [1579172693764, 7740.19575198222], [1579176150966, 7783.810765349375], [1579179777646, 7820.120118879878], [1579183520380, 7771.197870680319], [1579187069894, 7767.499018138037], [1579190874085, 7803.287257157879], [1579194063514, 7759.012550975988], [1579197766511, 7789.81609732262], [1579201469373, 7803.853493326131], [1579205089374, 7813.5299575404715], [1579208583708, 7834.6623495156955], [1579212155105, 7803.900676263581], [1579215636272, 7828.884363214726]], '2020-01-17': [[1579219496246, 7829.528156380277], [1579223272129, 7788.6409123703115], [1579226573118, 7820.041649760146], [1579230180220, 7845.455571244431], [1579233849766, 7877.233919948928], [1579237458079, 7896.288493417649], [1579241057320, 7959.744609349825], [1579244856601, 7933.472575313059], [1579248345087, 8002.795210381626], [1579252056221, 7992.264327634163], [1579255651818, 8038.762567925239], [1579259067615, 8003.886452229547], [1579262861708, 7997.206163585122], [1579266152365, 7933.322371772948], [1579269774566, 7941.058916151548], [1579273533708, 7903.827213646449], [1579277151197, 7966.136480812232], [1579280860766, 7971.027306966149], [1579284313484, 7971.934810404329], [1579287877380, 8009.385893140195], [1579291244752, 7959.16961663656], [1579295079873, 8000.039996893036], [1579298433171, 8018.016939713278], [1579302170858, 8045.744772499038]], '2020-01-18': [[1579305859609, 8010.37237889136], [1579309758313, 8050.71681758773], [1579312849222, 8009.654310417058], [1579316653759, 8015.043636356447], [1579320277270, 8030.542147436647], [1579324144341, 7972.148270023783], [1579327524009, 7967.250565016771], [1579331085945, 7977.651891667493], [1579334695909, 7973.023264459858], [1579338278152, 7980.979813435682], [1579341845124, 7996.488328307838], [1579345385867, 7999.405357574028], [1579349128351, 7978.69549380716], [1579352669311, 8014.679192259284], [1579356263996, 8030.310264702822], [1579360166015, 8023.821831214518], [1579363382633, 8008.818625735187], [1579367063368, 8013.987218889439], [1579370682108, 8023.787159888265], [1579374265484, 8019.822072276246], [1579377847675, 8010.1443460205855], [1579381539695, 8018.7896541029895], [1579384836172, 8028.958084793221], [1579388631625, 8050.842368113727]], '2020-01-19': [[1579392282472, 8030.890983244613], [1579395636425, 8061.866686145643], [1579399224455, 8216.007975520393], [1579402947092, 8226.919957354903], [1579406656525, 8222.886116541908], [1579410238441, 8224.239650565496], [1579413649681, 8205.911010111877], [1579417363081, 8157.152361113717], [1579420944875, 8177.97227737549], [1579424664495, 8173.871144747667], [1579428263387, 8156.109109794036], [1579431753802, 8137.29057987931], [1579435244218, 7814.583358700629], [1579439071133, 7772.285650857634], [1579442695739, 7780.630397108771], [1579446465950, 7763.2178480007], [1579449948660, 7789.6434302976095], [1579453478156, 7787.825597817771], [1579457246499, 7802.961650629347], [1579460576842, 7790.654797462437], [1579464260876, 7804.4072040483525], [1579467952204, 7787.797157621186], [1579471537908, 7851.879029063103], [1579475064912, 7805.271071903182]], '2020-01-20': [[1579478664166, 7833.230953209291], [1579482285138, 7810.92627022683], [1579485914245, 7798.302533029035], [1579489438453, 7790.32623856723], [1579493092099, 7788.020275311903], [1579496578451, 7787.78138097779], [1579500330485, 7810.065525411498], [1579503836326, 7825.845942129215], [1579507444922, 7802.655799216089], [1579511082950, 7794.813452331958], [1579514705798, 7800.292506325777], [1579518175056, 7798.376771017796], [1579522060077, 7778.046306055055], [1579525451764, 7737.659839703671], [1579529162238, 7750.97600170709], [1579532673500, 7804.348014177352], [1579536453918, 7825.263884875964], [1579539844678, 7803.464807862253], [1579543390879, 7793.165521487865], [1579547071121, 7802.812384459461], [1579550751458, 7809.89383182753], [1579554310481, 7806.780963786536], [1579557970143, 7815.779814198295], [1579561456292, 7787.525179838164]], '2020-01-21': [[1579565263674, 7778.216161699133], [1579568491536, 7778.576111004177], [1579572360512, 7790.58520906397], [1579575898237, 7797.943156884979], [1579579492300, 7799.098825372376], [1579583252959, 7798.363687506746], [1579586673077, 7797.468407743188], [1579590370244, 7794.842211674175], [1579593908233, 7770.471401406238], [1579597656755, 7788.101106799241], [1579601048154, 7769.118072419703], [1579604701539, 7788.214645875839], [1579608276660, 7771.962516387291], [1579611756453, 7778.576698978925], [1579615448100, 7787.289903375638], [1579618978254, 7780.942778759738], [1579622658986, 7780.340422858654], [1579626443644, 7781.446534153162], [1579629916309, 7781.009893393814], [1579633452663, 7758.32904631164], [1579637130461, 7677.815621767681], [1579640702090, 7827.521147010162], [1579644306565, 7874.453341416186], [1579647845600, 7870.1534132323495]], '2020-01-22': [[1579651504054, 7870.658879746492], [1579655044639, 7870.460172634394], [1579658862411, 7862.656586542367], [1579662260712, 7841.613045735032], [1579665922206, 7850.433714420304], [1579669666521, 7868.628873292414], [1579673057390, 7858.372843862238], [1579676765671, 7891.666394541583], [1579680319969, 7866.1013932865935], [1579683868660, 7817.605487493689], [1579687519442, 7812.948569530305], [1579691045849, 7802.976436355602], [1579694929267, 7809.329495680063], [1579698460195, 7807.1375526528245], [1579701787069, 7780.536209050242], [1579705659621, 7798.523596335013], [1579708970866, 7816.178981473907], [1579712562614, 7826.234825586165], [1579716199966, 7816.755202271601], [1579719769228, 7805.668906756368], [1579723468653, 7796.810199521593], [1579727065596, 7801.541985148513], [1579730725114, 7794.0053622860405], [1579734296120, 7792.260480404335]], '2020-01-23': [[1579737923422, 7810.331599413813], [1579741482109, 7798.341569884304], [1579745102688, 7755.548237521075], [1579748692452, 7747.581742829631], [1579752347327, 7747.7162179404095], [1579755753895, 7734.618874503941], [1579759370504, 7709.76781295834], [1579762972075, 7675.2405640193765], [1579766590157, 7724.144833134326], [1579770160694, 7687.711728465318], [1579773811605, 7636.296464436428], [1579777458307, 7607.9180222098785], [1579781047681, 7602.186403377761], [1579784763261, 7584.333684480801], [1579788342587, 7526.574022183096], [1579792076717, 7549.86796300626], [1579795363624, 7568.421858765808], [1579798955949, 7560.415789145365], [1579802713522, 7527.70622618529], [1579806469427, 7534.36521690337], [1579809875705, 7567.052644668243], [1579813521502, 7565.642595575132], [1579816827346, 7604.762753839106], [1579820741164, 7601.027355446122]], '2020-01-24': [[1579824312638, 7613.073822327722], [1579827784060, 7598.917022360509], [1579831471435, 7563.09011944782], [1579835119187, 7503.406774564364], [1579838460762, 7545.712155431217], [1579842261389, 7513.141934886699], [1579845921797, 7532.835562764139], [1579849473185, 7550.678123129936], [1579853121615, 7531.650380437501], [1579856572826, 7537.333387395709], [1579860290061, 7493.547179729139], [1579863783825, 7469.018382165899], [1579867664596, 7597.2608443935715], [1579871052527, 7638.588868410505], [1579874652336, 7648.729447957561], [1579878483390, 7668.331435412348], [1579881873875, 7697.111949952444], [1579885467852, 7665.28122460704], [1579889106448, 7677.4516568494355], [1579892761321, 7686.042624213522], [1579896348826, 7706.838007325239], [1579899909630, 7687.717121070032], [1579903504076, 7707.727786431602], [1579907102041, 7666.7848735825055]], '2020-01-25': [[1579910670744, 7648.164647841271], [1579914169724, 7540.88938198903], [1579917892909, 7514.695869361304], [1579921504914, 7544.168047840115], [1579925103041, 7521.154994795353], [1579928588961, 7532.944398489148], [1579932462925, 7541.303433476884], [1579935941344, 7548.8977753012705], [1579939493662, 7540.475070222703], [1579942976142, 7576.6637132339565], [1579946478474, 7570.027098494843], [1579950160614, 7544.305526272696], [1579953796427, 7539.720183298389], [1579957487517, 7528.855385481023], [1579961245975, 7553.103349395352], [1579964854375, 7544.71228085121], [1579968458881, 7558.823393479626], [1579971894058, 7577.157531525524], [1579975505769, 7562.93274064593], [1579979050407, 7563.245197808236], [1579982425542, 7582.792308568477], [1579986153509, 7587.899450692668], [1579989850701, 7604.5070964447195], [1579993533396, 7577.464636149478]], '2020-01-26': [[1579997123294, 7572.214712229956], [1580000650642, 7552.072145717308], [1580004277449, 7559.448991628604], [1580007798128, 7554.318379617615], [1580011230700, 7588.580490085373], [1580014856492, 7587.932622221603], [1580018435223, 7592.954956571466], [1580022190893, 7572.201235649254], [1580025770246, 7590.255468146144], [1580029474967, 7623.4054648037545], [1580032865841, 7633.978122934128], [1580036471309, 7655.976474672644], [1580040275268, 7662.432774731307], [1580043892535, 7663.439341334359], [1580047500419, 7654.489891802942], [1580051044962, 7661.079252561991], [1580054578828, 7659.350716175926], [1580058275364, 7700.290885184062], [1580061792278, 7762.73026498224], [1580065377880, 7785.06593932656], [1580069084369, 7763.515375870527], [1580072669740, 7773.319127878293], [1580076250026, 7782.943104576626], [1580079859943, 7755.814651267381]], '2020-01-27': [[1580083384530, 7796.2224179936775], [1580087092283, 7831.483560564684], [1580090674380, 7833.92182600773], [1580094309847, 7823.1154384334495], [1580097910459, 7846.35864358475], [1580101492083, 7811.255751818869], [1580105093039, 7833.6602051139635], [1580108689478, 7840.922213808768], [1580112309037, 7833.888467116069], [1580115919339, 7763.509367245525], [1580119506496, 7828.597651398348], [1580123107008, 7813.807096001559], [1580126540505, 7921.3678247890975], [1580130047536, 7903.967172136549], [1580133782188, 7903.424062458638], [1580137373986, 7925.072529482728], [1580141107284, 7938.751289005553], [1580144588747, 7948.089114104556], [1580148273267, 7948.423845365666], [1580151796667, 7976.904099924645], [1580155452361, 8089.546242605218], [1580158982326, 8127.666203251946], [1580162571312, 8108.2232888238295], [1580166278772, 8076.951091787429]], '2020-01-28': [[1580169778540, 8057.801665076384], [1580173275066, 8202.827939997871], [1580177058585, 8248.621949133512], [1580180682791, 8245.314855344493], [1580184319851, 8229.542198772879], [1580187768773, 8209.879046318418], [1580191461800, 8194.963799215368], [1580195242984, 8151.594701336608], [1580198596838, 8187.476593060546], [1580202172555, 8136.633074738743], [1580205847399, 8131.346412740599], [1580209452516, 8164.4259836673], [1580213092463, 8210.017397453803], [1580216579881, 8186.581030584206], [1580220290105, 8230.117126734249], [1580223755466, 8219.411661636055], [1580227386095, 8191.427799790694], [1580230956216, 8137.839974579118], [1580234421372, 8151.432733434773], [1580238293012, 8145.576393213208], [1580241864219, 8174.540348042755], [1580245463794, 8204.15929592315], [1580248966514, 8213.521718342168], [1580252580300, 8279.505155181245]], '2020-01-29': [[1580256284225, 8456.002845134844], [1580259911895, 8448.267107638887], [1580263375694, 8455.051799753508], [1580266977325, 8441.024369084947], [1580270649596, 8468.973199284199], [1580274144210, 8453.498088791155], [1580277936345, 8475.775440274127], [1580281513775, 8460.286007856464], [1580284990912, 8475.832712785761], [1580288535230, 8490.840194565546], [1580292239209, 8451.420438302057], [1580295913585, 8531.231871066462], [1580299452866, 8420.048660673718], [1580302946853, 8413.039984808114], [1580306647933, 8443.720529745822], [1580310266880, 8469.730985250151], [1580313864854, 8411.743080766746], [1580317247109, 8466.332995566068], [1580320932856, 8470.604242131409], [1580324661458, 8475.551166010708], [1580328254271, 8491.732665415022], [1580331841471, 8500.748817592172], [1580335442824, 8478.700639017901], [1580338996824, 8465.217223158414]], '2020-01-30': [[1580342832299, 8422.410239289862], [1580346244324, 8415.17826214271], [1580349846371, 8422.156796105586], [1580353455370, 8387.961453794236], [1580356956414, 8416.100260535237], [1580360630277, 8432.478017242856], [1580364186116, 8452.474408861148], [1580367839207, 8439.142243754579], [1580371366563, 8515.942206267417], [1580374967491, 8503.981707670764], [1580378579275, 8485.344493006523], [1580382326877, 8466.55847815241], [1580386028209, 8469.6953603277], [1580389531854, 8495.234450040116], [1580393108283, 8511.039551910222], [1580396830351, 8472.523684113765], [1580400435582, 8499.620775158142], [1580403924884, 8460.998902788806], [1580407552249, 8574.260596423623], [1580411090064, 8608.445681841704], [1580414737511, 8607.014761169221], [1580418283064, 8672.731945518386], [1580421794008, 8650.105202954763], [1580425225806, 8653.631891034625]], '2020-01-31': [[1580428946341, 8621.674924158713], [1580432587011, 8571.942545205071], [1580436149538, 8565.795561389046], [1580439637083, 8565.524473132326], [1580443373640, 8530.443620085909], [1580446973267, 8531.16775103599], [1580450685820, 8482.572664792586], [1580454318731, 8485.029302217225], [1580457877396, 8465.726184211188], [1580461458206, 8503.548420559386], [1580465124270, 8481.292726923191], [1580468729534, 8430.155222826257], [1580472168082, 8441.844022223924], [1580475764456, 8373.130918179528], [1580479501966, 8391.796458748608], [1580483060439, 8361.501141352552], [1580486595625, 8423.125070907921], [1580490139791, 8354.46044239591], [1580493784482, 8355.842316450413], [1580497480954, 8390.924879097945], [1580501095286, 8371.37033920178], [1580504688454, 8386.734753245379], [1580508259121, 8441.538355170253], [1580511748596, 8436.140192068426]] }

		self.assertEqual(organized_prices, expected)


	def test_get_midnight_price(self):
		date_str = "2020-01-02"
		day_prices = [[1577923200000, 6412.448167227617]]
		prev_day_prices = [[1577836800000, 6412.84639784161]]
		midnight_price = get_midnight_price(date_str, day_prices, prev_day_prices)
		expected = 6412.448167227617

		self.assertEqual(midnight_price, expected)


	def test_get_midnight_price2(self):
		date_str = "2020-01-02"
		day_prices = [[1577923235223, 6413.051795808254], [1577927145804, 6419.084371212281], [1577930733698, 6392.367191498962], [1577934447405, 6378.0750217390005], [1577937931269, 6348.1781473406545], [1577941655270, 6373.474640375365], [1577945118069, 6363.841848813113], [1577948687580, 6359.356689913901], [1577952284835, 6344.350466003507], [1577955849770, 6375.709214312489], [1577959753494, 6390.020679840621], [1577963256994, 6393.573096018375], [1577966701336, 6382.492481923091], [1577970568353, 6391.428200519827], [1577973646800, 6363.1359014027885], [1577977521707, 6383.578389826709], [1577981168137, 6378.76254467646], [1577984566594, 6321.199403361324], [1577988735259, 6234.781879558442], [1577991745726, 6248.848795231115], [1577995453801, 6256.160212581229], [1577999375587, 6232.533890958317], [1578002702067, 6249.198431984557], [1578006042775, 6249.151313222172]]
		prev_day_prices = [[1577837037103, 6412.84639784161], [1577840443088, 6400.183195857016], [1577844174112, 6452.701266161403], [1577848140451, 6472.734997584653], [1577851238015, 6463.273479119187], [1577855114844, 6459.984936772221], [1577858869352, 6466.275022382196], [1577862464201, 6445.939706616753], [1577866051896, 6427.706404769181], [1577869367988, 6408.749636232671], [1577872864963, 6408.922572379971], [1577876736509, 6416.878539022916], [1577880529069, 6416.232375709836], [1577883926430, 6420.0381517729265], [1577887639980, 6415.875056068972], [1577890824719, 6440.739721596347], [1577894995373, 6430.386758909359], [1577898034524, 6458.564511092221], [1577901618835, 6447.260372770252], [1577905779503, 6427.049100904037], [1577908846483, 6418.772496993268], [1577912653436, 6448.265169960227], [1577916261128, 6424.911291990242], [1577919763140, 6412.022709010401]]
		midnight_price = get_midnight_price(date_str, day_prices, prev_day_prices)
		expected = 6413.051795808254

		self.assertEqual(midnight_price, expected)		


	def test_find_longest_bearish_trend(self):
		data = load_file("prices_1_month2.json")
		longest_bearish_trend = find_longest_bearish_trend(data)
		expected = 2

		self.assertEqual(longest_bearish_trend, expected)


	def test_find_longest_bearish_trend2(self):
		data = load_file("prices.json")
		longest_bearish_trend = find_longest_bearish_trend(data)
		expected = 7

		self.assertEqual(longest_bearish_trend, expected)


	def test_get_highest_trading_volume(self):
		data = load_file("prices.json")
		highest_volume_date, highest_volume = get_highest_trading_volume(data)
		expected_date = "2020-02-11"
		expected_volume = 74607356578.95918

		self.assertEqual(highest_volume_date, expected_date)
		self.assertEqual(highest_volume, expected_volume)

		data2 = load_file('prices_1_month2.json')

		highest_volume_date2, highest_volume2 = get_highest_trading_volume(data2)
		expected_date2 = "2020-01-15"
		expected_volume2 = 50796448042.52202

		self.assertEqual(highest_volume_date2, expected_date2)
		self.assertEqual(highest_volume2, expected_volume2)


	def test_downward_only(self):
		data = load_file("prices.json")
		is_downward_only = downward_only(data)

		self.assertFalse(is_downward_only)

		data2 = load_file("fake-prices.json")
		is_downward_only2 = downward_only(data2)

		self.assertTrue(is_downward_only2)


	def test_find_best_buy_and_sell_dates(self):
		data = load_file("prices_1_month2.json")
		date_to_buy, date_to_sell = get_days_to_by_and_sell(data)

		expected_date_to_buy = "2020-01-03"
		expected_date_to_sell = "2020-01-31"

		self.assertEqual(date_to_buy, expected_date_to_buy)
		self.assertEqual(date_to_sell, expected_date_to_sell)

		data2 = load_file("fake-prices.json")
		date_to_buy2, date_to_sell2 = get_days_to_by_and_sell(data2)

		expected_date_to_buy2 = "Don't buy"
		expected_date_to_sell2 = "Don't sell"

		self.assertEqual(date_to_buy2, expected_date_to_buy2)
		self.assertEqual(date_to_sell2, expected_date_to_sell2)


if __name__ == '__main__':
    unittest.main()